<div class="article">
  <h2>
    Ajouter une annonce
  </h2>

  <div *ngIf="currentStep === -1">
    <p>Choisissez la catégorie de votre annonce</p>
    <mat-list>
      <mat-list-item
        *ngFor="let cat of categories"
        class="pointer"
        (click)="selectCategorie(cat.uuid)">
        {{ cat.nom.fr }}
        <mat-divider></mat-divider>
      </mat-list-item>
    </mat-list>
  </div>

  <mat-horizontal-stepper class="steppers" #addstepper>
    <mat-step
      [label]="step.label.fr"
      *ngFor="let step of fiche; let indexStep = index"
    >
      <header>
        <h3>{{ step.label.fr }}</h3>
      </header>
      <div>
        <div
          *ngFor="let ficheItem of step?.fiche" class="article-fiche">
          <div class="article-item">

            <mat-card *ngIf="ficheItem.type === 'image'">
              <mat-card-subtitle>{{ ficheItem.label.fr }}</mat-card-subtitle>
              <app-upload-file (uploadChanged)="updateFiles($event, ficheItem.key)"></app-upload-file>
            </mat-card>

            <mat-card *ngIf="ficheItem.type === 'text' || ficheItem.type === 'number'">
              <mat-form-field>
                <input [type]="ficheItem.type"
                       [placeholder]="ficheItem.label.fr"
                       matInput
                       [(ngModel)]="formData.fiche[ficheItem.key]" />
              </mat-form-field>
            </mat-card>

            <mat-card *ngIf="ficheItem.type === 'select'">
              <mat-form-field>
                <mat-select
                  [placeholder]="ficheItem.label.fr"
                  [(ngModel)]="formData.fiche[ficheItem.key]">
                  <mat-option *ngFor="let item of ficheItem.items" [value]="item">
                    {{ item }}
                  </mat-option>
                </mat-select>
              </mat-form-field>
            </mat-card>

            <mat-card *ngIf="ficheItem.type === 'bool'">
              <mat-slide-toggle
                class="example-margin"
                [(ngModel)]="formData.fiche[ficheItem.key]">
                {{ ficheItem.label.fr }}
              </mat-slide-toggle>
            </mat-card>

            <mat-card *ngIf="ficheItem.type === 'textarea'">
              <mat-form-field>
                <textarea
                  [type]="ficheItem.type"
                  [placeholder]="ficheItem.label.fr"
                  matInput
                  rows="10"
                  [(ngModel)]="formData.fiche[ficheItem.key]"></textarea>
              </mat-form-field>
            </mat-card>

          </div>

        </div>

        <div class="button-row">
          <button
            class="pointer"
            *ngIf="indexStep > 0"
            mat-raised-button matStepperPrevious>&lt; Précédent</button>
          <button
            class="pointer"
            mat-raised-button
            *ngIf="indexStep <= 0"
            (click)="previous(indexStep)">&lt; Précédent</button>
          <button
            class="pointer"
            *ngIf="indexStep < totalStep - 1"
            mat-raised-button matStepperNext>Suivant &gt;</button>
          <button
            class="pointer"
            mat-raised-button
            *ngIf="indexStep >= totalStep - 1"
            (click)="add()">Terminer</button>
        </div>
      </div>

    </mat-step>
  </mat-horizontal-stepper>
</div>
